import{c as y,r as s,R as e,m as v,A as k,L as j,X as C,s as I}from"./index-sxCneeDl.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=y("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),A=({onScanSuccess:x,onClose:m})=>{const c=s.useRef(null),u=s.useRef(null),[b,p]=s.useState(null),[l,h]=s.useState(!1),[f,o]=s.useState(null);s.useEffect(()=>(g(),()=>w()),[]);const g=async()=>{o(null);try{const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});p(t),c.current&&(c.current.srcObject=t)}catch{o("Không thể truy cập Camera. Vui lòng cấp quyền.")}},w=()=>{b&&b.getTracks().forEach(t=>t.stop())},E=async()=>{if(!c.current||l)return;h(!0),o(null);const t=c.current,i=u.current;let a=t.videoWidth,r=t.videoHeight;const n=1920;a>r?a>n&&(r=Math.round(r*(n/a)),a=n):r>n&&(a=Math.round(a*(n/r)),r=n),i.width=a,i.height=r,i.getContext("2d").drawImage(t,0,0,a,r);const N=i.toDataURL("image/jpeg",.9),d=await I(N);d.error?(o(d.error),h(!1)):(navigator.vibrate&&navigator.vibrate(50),x(d),m())};return e.createElement("div",{className:"fixed inset-0 bg-black z-[200] flex flex-col items-center justify-center p-4"},e.createElement("div",{className:"relative w-full max-w-md aspect-[3/4] bg-stone-900 rounded-[32px] overflow-hidden shadow-2xl border border-white/10"},e.createElement("video",{ref:c,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),e.createElement("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none"},e.createElement("div",{className:"w-64 h-64 border-2 border-indigo-400/50 rounded-3xl relative"},e.createElement("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-indigo-500 rounded-tl-xl"}),e.createElement("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-indigo-500 rounded-tr-xl"}),e.createElement("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-indigo-500 rounded-bl-xl"}),e.createElement("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-indigo-500 rounded-br-xl"}),l&&e.createElement(v.div,{animate:{top:["0%","100%","0%"]},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute left-0 right-0 h-0.5 bg-indigo-500 shadow-[0_0_15px_rgba(99,102,241,0.8)]"}))),e.createElement(k,null,(f||l)&&e.createElement(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"absolute bottom-10 left-6 right-6 p-4 rounded-2xl bg-black/60 backdrop-blur-md text-white text-sm font-medium text-center border border-white/10"},l?e.createElement("div",{className:"flex items-center justify-center gap-2"},e.createElement(j,{className:"animate-spin",size:16}),"AI đang phân tích hình ảnh..."):e.createElement("div",{className:"text-rose-400"},f))),e.createElement("button",{onClick:m,className:"absolute top-6 right-6 w-10 h-10 bg-black/40 backdrop-blur-md rounded-full flex items-center justify-center text-white"},e.createElement(C,{size:20}))),e.createElement("div",{className:"mt-8 flex items-center gap-6"},e.createElement("button",{onClick:g,className:"w-12 h-12 bg-white/10 text-white rounded-full flex items-center justify-center hover:bg-white/20 transition-colors"},e.createElement(R,{size:20})),e.createElement("button",{onClick:E,disabled:l,className:"w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-xl active:scale-90 transition-transform disabled:opacity-50"},e.createElement("div",{className:"w-16 h-16 border-4 border-stone-200 rounded-full flex items-center justify-center"},e.createElement("div",{className:"w-12 h-12 bg-black rounded-full"}))),e.createElement("div",{className:"w-12"})," "),e.createElement("p",{className:"text-white/40 text-xs font-medium mt-6 text-center max-w-[200px]"},"Căn chỉnh nhãn chai hoặc mã vạch vào khung hình để quét"),e.createElement("canvas",{ref:u,className:"hidden"}))};export{A as default};
